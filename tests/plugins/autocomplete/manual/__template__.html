<style>
	body {
		margin: 0px;
		position: static;
	}
</style>

<div style="padding: 1500px">
	<textarea id="editor1" >
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Vitae perferendis architecto sapiente veniam eius eos enim mollitia, sint accusamus sed voluptatum, consectetur illum nam, ab quod id amet, dignissimos quasi possimus excepturi natus maxime ea. Nihil ea voluptatibus tempora, corporis reiciendis vitae quo tenetur sint distinctio perspiciatis error fugit incidunt eaque at asperiores numquam, similique dolorum.</p>
	</textarea>
</div>

<script>
	var editor;

	CKEDITOR.replace( 'editor1', {
		width: 600,
		extraPlugins: 'textmatch',
		on: {
			instanceReady: function( evt ) {
				editor = evt.editor;

				new CKEDITOR.plugins.autocomplete( editor, getTextTestCallback(), dataCallback );
			}
		}
	} );

	// The body of the root html element has additional margin-left to display bender manual-sidebar which has fixed position.
	// Our autcomplete view lives inside root html so with its margin it has invalid position relative to the editor.
	// We have to change position of our editor relative to the root html by setting position:static ( see style tag ) and move it to the center of the page
	// so it won't be hidden below sidebar.
	window.scrollTo( 1500, 1500 );

	function getTextTestCallback() {
		return function( range ) {
			return CKEDITOR.plugins.textMatch.match( range, matchCallback );
		};
	}

	function matchCallback( text, offset ) {
		var left = text.slice( 0, offset ),
			right = text.slice( offset ),
			match = left.match( new RegExp( '@\\w*$' ) );

		if ( !match ) {
			return null;
		}

		return { start: match.index, end: offset };
	}

	function dataCallback( query, range, callback ) {
		var data = [
			{ id: 1, name: '@john' },
			{ id: 2, name: '@thomas' },
			{ id: 3, name: '@anna' },
			{ id: 4, name: '@cris' },
			{ id: 5, name: '@julia' }
		];

		callback(
			data.filter( function( item ) {
				return item.name.indexOf( query ) === 0;
			} )
		);
	}

</script>
